<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:si="http://java.sun.com/jsf/composite/ccomponent"
                template="/WEB-INF/templates/template.xhtml">
    <ui:define name="content">
        <h:form id="TransactionReport"
                enctype="multipart/form-data">
            <div class="card card-w-title">
                <div class="ui-fluid">
                    <div class="ui-g">
                        <div class="ui-g-12">
                            <ui:fragment>
                                <h1>#{messages.InvoiceReport}</h1>
                            </ui:fragment>
                            <div class="card card-w-title">
                                <p:fieldset legend="View Report"
                                            toggleable="false" toggleSpeed="500">

                                    <p:panelGrid columns="6"
                                                 columnClasses="ui-grid-col-0,ui-grid-col-4,ui-grid-col-0,ui-grid-col-4,ui-grid-col-0,ui-grid-col-4"
                                                 layout="grid" styleClass="ui-panelgrid-blank form-group"
                                                 style="border:0px none; background-color:transparent;">

                                        <p:outputLabel for="year"/>
                                        <h:panelGroup styleClass="md-inputfield">
                                            <p:autoComplete
                                                id="year"
                                                converter="#{financialPeriodConverter}"
                                                dropdown="true"
                                                forceSelection="true"
                                                effect="fold"
                                                completeMethod="#{invoiceReport.completeFinancialPeriods()}"
                                                value="#{invoiceReport.financialPeriod}"
                                                var="financialPeriod"
                                                itemValue="#{financialPeriod}"
                                                itemLabel="#{financialPeriod.name}"
                                                required="true"
                                                requiredMessage="Please select financial period">
                                            </p:autoComplete>
                                            <label>#{messages.FinancialPeriod}</label>
                                            <p:message for="year" />
                                        </h:panelGroup>

                                        <p:outputLabel/>
                                        <h:panelGroup styleClass="md-inputfield">
                                        </h:panelGroup>

                                        <p:outputLabel/>
                                        <h:panelGroup styleClass="md-inputfield">
                                        </h:panelGroup>

                                        <p:outputLabel/>
                                        <p:commandButton value="#{messages.View}" update="@form"
                                                         action="#{invoiceReport.view}" />
                                    </p:panelGrid>
                                </p:fieldset>

                                <h:panelGroup id="invoice">
                                    <p:fieldset legend="Invoice Report" rendered="#{invoiceReport.invoicelist.size() > 0}"
                                                toggleable="false" toggleSpeed="500">
                                    <p:dataTable var="invoice" 
                                                 value="#{invoiceReport.invoicelist}"
                                                 selectionMode="single"
                                                 reflow="true"
                                                 rowIndexVar="index"
                                                 rowKey="#{invoice.invoiceId}" 
                                                 paginator="true" rows="10"
                                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {TableHeader}"
                                                 id="invoiceTable" >
                                        <f:facet name="{TableHeader}">
                                            <p:outputLabel styleClass="tableCustomHeader" value="Invoice report" />
                                        </f:facet>

                                        <p:column width="30" style="text-align: center">
                                            <h:panelGroup layout="block">
                                                <h:panelGroup layout="block" style="display:block" styleClass="label status-#{invoice.statusName}" >
                                                    <h:outputText value=" "/>
                                                </h:panelGroup>
                                            </h:panelGroup>
                                        </p:column>
                                        <p:column headerText="#{messages.refnumber}" sortBy="#{invoice.invoiceReferenceNumber}" filterMatchMode="contains" filterBy="#{invoice.invoiceReferenceNumber}">
                                            <h:outputText value="#{invoice.invoiceReferenceNumber}" />
                                        </p:column>

                                        <p:column headerText="#{messages.date}" sortBy="#{invoice.invoiceDate}" filterMatchMode="contains" filterBy="#{invoice.invoiceDate}">
                                            <h:outputText value="#{invoice.invoiceDate}" >
                                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column headerText="#{messages.due_date}" sortBy="#{invoice.invoiceDueDate}" filterMatchMode="contains" filterBy="#{invoice.invoiceDueDate}">
                                            <h:outputText value="#{invoice.invoiceDueDate}" >
                                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                                            </h:outputText>
                                        </p:column>

                                        <p:column headerText="#{messages.contact_name}" filterMatchMode="contains" filterBy="#{invoice.invoiceContact.firstName} #{invoice.invoiceContact.lastName}"
                                                  sortBy="#{invoice.invoiceContact.firstName} #{invoice.invoiceContact.lastName}">
                                            <h:outputText value="#{invoice.invoiceContact.firstName} #{invoice.invoiceContact.lastName}" />
                                        </p:column>
                                        <p:column headerText="#{messages.no_of_items}" filterMatchMode="contains" filterBy="#{invoice.invoiceLineItems.size()}"
                                                  sortBy="#{invoice.invoiceLineItems.size()}" styleClass="amount">
                                            <h:outputText value="#{invoice.invoiceLineItems.size()}" />
                                        </p:column>
                                       
                                        <p:column headerText="#{messages.total_cost}" filterMatchMode="contains" filterBy="#{total}"
                                                  sortBy="#{invoice.invoiceAmount}" styleClass="amount">
                                            <h:outputText value="#{invoice.currencyCode.currencySymbol} " />
                                            <h:outputText value="#{invoice.invoiceAmount}" >
                                                <f:convertNumber type="currency" currencySymbol=""/>
                                            </h:outputText>
                                        </p:column>
                                    </p:dataTable>
                                     </p:fieldset>
                                  </h:panelGroup>
                                <br />
                            </div>
                        </div>
                    </div>
                </div>
                <p:toolbar>
                    <f:facet name="left">
                        <si:cbutton type="cancel"/>
                    </f:facet>
                    <f:facet name="right">
                        <si:cbutton type="home"/>
                    </f:facet>

                </p:toolbar>
            </div>
        </h:form>
    </ui:define>
</ui:composition>
