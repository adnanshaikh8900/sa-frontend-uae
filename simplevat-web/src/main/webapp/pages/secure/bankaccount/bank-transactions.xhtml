<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:si="http://java.sun.com/jsf/composite/ccomponent"
                template="/WEB-INF/templates/template.xhtml">

    <ui:define name="title">#{messages.bank_accounts}</ui:define>

    <ui:define name="content">

        <si:cdataPanel newAction= "#{transactionController.createTransaction()}" >
            <h:form>
                <p:dataTable var="transaction"
                             id="transactionsTable"
                             value="#{transactionListController.transactions}"
                             paginator="true" rows="10"
                              paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {TableHeader}">
                    
                    <f:facet name="{TableHeader}">
                        <p:outputLabel styleClass="tableCustomHeader" value="#{transactionListController.selectedBankAccountModel.bankAccountName}" />
                    </f:facet>

                    <p:column>

                        <h:panelGroup rendered="#{transaction.transactionStatus.explainationStatusName eq 'EXPLAINED'}">
                            <i class="fa fa-check" style="color: green;"></i>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{transaction.transactionStatus.explainationStatusName eq 'UNEXPLAINED'}">
                            <i class="fa fa-close" style="color: red;"></i>
                        </h:panelGroup>

                    </p:column>

                    <p:column headerText="#{messages.date}" sortBy="#{transaction.transactionDate.time}">
                        <h:outputText value="#{transaction.transactionDate.time}" >
                            <f:convertDateTime pattern="dd/MM/yyyy" />
                        </h:outputText>
                    </p:column>

                    <p:column headerText="#{messages.description}" >
                        <h:outputText value="#{transaction.transactionDescription}" />
                    </p:column>

                    <p:column headerText="#{messages.credit}" sortBy="#{transaction.transactionAmount}">
                        <h:outputText value="#{transaction.transactionAmount}" rendered="#{transaction.debitCreditFlag.toString() eq 'C'}" />
                    </p:column>

                    <p:column headerText="#{messages.debit}" sortBy="#{transaction.transactionAmount}">
                        <h:outputText value="#{transaction.transactionAmount}" rendered="#{transaction.debitCreditFlag.toString() eq 'D'}" />
                    </p:column>

                    <p:column headerText="#{messages.current_balance}">
                        <h:outputText value="#{transaction.currentBalance}" />
                    </p:column>

                    <p:column headerText="Action">

                        <p:commandButton icon="ui-icon-edit" styleClass="AquaButton" action="#{transactionController.editTransection}">
                            <f:setPropertyActionListener value="#{transaction}" target="#{transactionController.selectedTransactionModel}" />
                        </p:commandButton>

                        <p:commandButton icon="ui-icon-delete" styleClass="AquaButton" action="#{transactionController.deleteTransaction}" update="transactionsTable">
                            <f:setPropertyActionListener value="#{transaction}" target="#{transactionController.selectedTransactionModel}" />
                            <p:confirm header="#{messages.delete}" message="#{messages.are_you_sure_want_to_delete}" icon="ui-icon-alert" />
                        </p:commandButton>

                    </p:column>

                </p:dataTable>
            </h:form>

        </si:cdataPanel>

    </ui:define>

</ui:composition>