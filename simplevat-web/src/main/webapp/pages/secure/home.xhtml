<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:si="http://java.sun.com/jsf/composite/ccomponent"
                template="/WEB-INF/templates/template.xhtml">


    <ui:define name="title">Dashboard</ui:define>

    <ui:define name="head">
        <script type="text/javascript">
            //<![CDATA[
            function skinChart() {
                this.cfg.shadow = false;
                this.cfg.title = '';
                this.cfg.seriesColors = ['#FFC107', '#03A9F4'];
                this.cfg.grid = {
                    background: '#ffffff',
                    borderColor: '#ffffff',
                    gridLineColor: '#EEEEEE',
                    shadow: false
                };
                this.cfg.axesDefaults = {
                    rendererOptions: {
                        textColor: '#212121'
                    }
                };
                this.cfg.seriesDefaults = {
                    shadow: false,
                    lineWidth: 1,
                    markerOptions: {
                        shadow: false,
                        size: 7,
                        style: 'circle'
                    }
                }
            }
            //]]>
        </script>
        <style type="text/css">
            .main-content {
                padding: 0;
            }
        </style>
    </ui:define>

    <ui:define name="content">
        <h:form>
        <h:panelGroup layout="block" styleClass="ui-g dashboard" id="dashboardPanel">
            <h:panelGroup layout="block" styleClass="ui-g-12 ui-md-8">
                <div class="card overview">
                    <p:panel header="Cash Flow" style="height:400px; width: auto" id="cashFlowChartPanel">
                        <p:chart type="line" model="#{homeController.cashFlowLineChartModel}" rendered="#{homeController.renderCashFlowLineChartModel}"
                                 style="height:350px; width: auto" responsive="true" />
                    </p:panel>
                </div>
            </h:panelGroup>
            <p:blockUI block="cashFlowChartPanel" trigger="remoteCommandToLoadCashFlowChartPanel">
                Chart is Loading....
            </p:blockUI>

            <h:panelGroup layout="block" styleClass="ui-g-12 ui-md-4" >
                <p:scrollPanel header="Bank Accounts" mode="native"
                               style="height:400px" id="bankAccountPanel">
                    <ul class="activity-list">
                        <ui:repeat
                            value="#{homeController.bankAccountList}"
                            var="value">
                            <!--#{value.bankAccountId} -->

                            <li>
                                <div class="count" style="background-color: #00bcd4">
                                    #{value.bankAccountCurrency.currencySymbol}#{value.currentBalance}</div>
                                <div class="ui-g">
                                    <div class="ui-g-6">
                                        #{value.bankName}
                                        <div style="color: #757575; font-size: 14px;">Saving
                                            Account</div>
                                    </div>
                                    <div class="ui-g-6">
                                        Last Updated 15 May 2017
                                        <div>
                                            <p:graphicImage name="images/green-check.png"
                                                            library="ultima-layout" style="width: 10%" />
                                            Transactions Uptodate
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ui:repeat>
                    </ul>
                </p:scrollPanel>
            </h:panelGroup>
            <p:blockUI block="bankAccountPanel" trigger="remoteCommandToLoadBankAccountPanel">
                Bank Account Loading....
            </p:blockUI>
            <h:panelGroup layout="block" id="vatInOutPanel" styleClass="ui-g-12 ui-md-12">
                <si:cbox name="Vat In" icon="&#xE86C;"
                         amount="#{homeController.vatIn}" currency="$" />
                <si:cbox name="Vat Out" icon="&#xE8C9;"
                         amount="#{homeController.vatOut}" currency="$" />
                <si:cbox name="Vat Balance" icon="&#xE160;"
                         amount="#{homeController.vatBalance}" currency="$" />
                <si:cbox name="Transactions" icon="&#xE0BE;"
                         amount="#{homeController.numberOfTransaction}" currency="" />
            </h:panelGroup>
            <p:blockUI block="vatInOutPanel" trigger="remoteCommandToLoadVatInOutPanel">
                Loading....
            </p:blockUI>
            <div class="ui-g-12 ui-md-6">
                <p:panel header="Invoices and Expense" id="invoiceAndExpansePanel">
                    <p:chart type="line" model="#{homeController.animatedModel1}" rendered="#{not empty homeController.animatedModel1.series}"
                             style="width:100%;" responsive="true" />
                </p:panel>
            </div>
            <p:blockUI block="invoiceAndExpansePanel" trigger="remoteCommandToLoadInvoiceAndExpansePanel">
                Loading....
            </p:blockUI>
            <div class="ui-g-12 ui-md-6">
                <p:panel header="VAT Acivity" id="vatActivityPanel">
                    <p:chart type="bar" model="#{homeController.animatedModel2}" rendered="#{not empty homeController.animatedModel2.series}"
                             style="width:100%;" responsive="true" />
                </p:panel>
            </div>
            <p:blockUI block="vatActivityPanel" trigger="remoteCommandToLoadVatActivityPanel">
                Loading....
            </p:blockUI>
            <div class="ui-g-12 ui-md-8">
                <p:panel header="Calendar" style="height:100%" id="eventPanel">
                    <p:schedule value="#{homeController.eventModel}" rendered="#{not empty homeController.eventModel}"/>
                </p:panel>
            </div>
            <p:blockUI block="eventPanel" trigger="remoteCommandToLoadEventPanel">
                Calendar Loading....
            </p:blockUI>
            <div class="ui-g-12 ui-md-4">
                <p:panel header="Activity" style="height:100%" id="activityPanel">
                    <div class="activity-header">
                        <div class="ui-g">
                            <div class="ui-g-6">
                                <span style="font-weight: bold">Last Activity</span>
                                <!-- <p>Updated 1 minute ago</p> -->
                            </div>
                            <div class="ui-g-6" style="text-align: right">
                                <p:commandButton type="button" icon="ui-icon-update" />
                            </div>
                        </div>
                    </div>
                    <ul class="activity-list">
                        <ui:repeat var="activity" value="#{homeController.activities}">
                            <li>
                                    <!-- <div class="count">#{activity.field1}</div> -->
                                <div class="ui-g">
                                    <div class="ui-g-6">#{activity.field3}</div>
                                    <div class="ui-g-6">
                                        <h:outputText value="#{activity.strLastUpdateDate}">
                                            
                                        </h:outputText>
                                    </div>
                                </div>								
                                <div class="ui-g">
                                    <div class="ui-g-6">#{activity.field1}</div>
                                    <div class="ui-g-6">#{activity.field2}</div>
                                </div>								
                            </li>
                        </ui:repeat>
                    </ul>
                </p:panel>
            </div>
             <p:blockUI block="activityPanel" trigger="remoteCommandToLoadContentActivityPanel">
                Activity Loading....
            </p:blockUI>
        </h:panelGroup>
            <p:remoteCommand id="remoteCommandToLoadCashFlowChartPanel" autoRun="true" async="true" actionListener="#{homeController.lazyInitializationFlowChart}" update="cashFlowChartPanel"/>
            <p:remoteCommand id="remoteCommandToLoadBankAccountPanel" autoRun="true" async="true" actionListener="#{homeController.lazyInitializationBankAccount}" update="bankAccountPanel"/>
            <p:remoteCommand id="remoteCommandToLoadVatInOutPanel" autoRun="true" async="true" actionListener="#{homeController.lazyInitializationVatInOutCalculation}" update="vatInOutPanel"/>
            <p:remoteCommand id="remoteCommandToLoadInvoiceAndExpansePanel" autoRun="true" async="true" actionListener="#{homeController.lazyInitializationInvoiceAndExpanse}" update="invoiceAndExpansePanel"/>
            <p:remoteCommand id="remoteCommandToLoadVatActivityPanel" autoRun="true" async="true" actionListener="#{homeController.lazyInitializationVatActivity}" update="vatActivityPanel"/>
            <p:remoteCommand id="remoteCommandToLoadEventPanel" autoRun="true" async="true" actionListener="#{homeController.lazyInitializationEvent}" update="eventPanel"/>
            <p:remoteCommand id="remoteCommandToLoadContentActivityPanel" autoRun="true" async="true" actionListener="#{homeController.lazyInitializationActivity}" update="activityPanel"/>
        </h:form>
    </ui:define>
</ui:composition>